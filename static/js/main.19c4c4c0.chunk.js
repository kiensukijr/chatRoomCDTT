(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[0],{164:function(e,t,n){},165:function(e,t,n){},247:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(26),c=n.n(o),i=(n(164),n(165),n(257)),r=n(252),l=n(253),d=n(69),j=n(89);n(248),n(166),n(249);j.a.initializeApp({apiKey:"AIzaSyCbdcKzoneqxp3c0Ek6MIMMH8T2iy7GKbE",authDomain:"firechat-31465.firebaseapp.com",projectId:"firechat-31465",storageBucket:"firechat-31465.appspot.com",messagingSenderId:"355257303874",appId:"1:355257303874:web:7c3bd1a67d7f5d87567edb",measurementId:"G-0QMMRESJ11"}),j.a.analytics();const u=j.a.auth(),b=j.a.firestore();window.location.hostname;var m=j.a;const h=(e,t)=>{b.collection(e).add({...t,createdAt:m.firestore.FieldValue.serverTimestamp()})},p=e=>{const t=e.split(" ").filter((e=>e)),n=t.length;let a=[],s=[],o=[];for(let c=0;c<n;c++)a[c]=!1;!function e(c){for(let i=0;i<n;i++)a[i]||(a[i]=!0,s[c]=t[i],c===n-1&&o.push(s.join(" ")),e(c+1),a[i]=!1)}(0);return o.reduce(((e,t)=>[...e,...(e=>{const t=[];let n="";return e.split("").forEach((e=>{n+=e,t.push(n)})),t})(t)]),[])};var x=n(7);const{Title:O}=i.a,f=new m.auth.GoogleAuthProvider;function v(){return Object(x.jsx)("div",{children:Object(x.jsx)(r.a,{justify:"center",style:{height:800},children:Object(x.jsxs)(l.a,{span:8,children:[Object(x.jsx)(O,{style:{textAlign:"center"},level:3,children:"Toeic Chat Community"}),Object(x.jsx)(d.a,{style:{width:"100%",marginBottom:5},onClick:()=>(async e=>{const{additionalUserInfo:t,user:n}=await u.signInWithPopup(e);var a;(null===t||void 0===t?void 0:t.isNewUser)&&h("users",{displayName:n.displayName,email:n.email,photoURL:n.photoURL,uid:n.uid,providerId:t.providerId,keywords:p(null===(a=n.displayName)||void 0===a?void 0:a.toLowerCase())})})(f),children:"Sign in with Google"})]})})})}var g=n(127),y=n(27),C=n(36),I=n(262),R=n(37),w=n(254);const N=s.a.createContext();function A(e){let{children:t}=e;const[n,o]=Object(a.useState)({}),c=Object(y.f)(),[i,r]=Object(a.useState)(!0);return s.a.useEffect((()=>{const e=u.onAuthStateChanged((e=>{if(e){const{displayName:t,email:n,uid:a,photoURL:s}=e;return o({displayName:t,email:n,uid:a,photoURL:s}),r(!1),void c.push("/")}o({}),r(!1),c.push("/login")}));return()=>{e()}}),[c]),Object(x.jsx)(N.Provider,{value:{user:n},children:i?Object(x.jsx)(w.a,{style:{position:"fixed",inset:0}}):t})}var L=(e,t)=>{const[n,o]=Object(a.useState)([]);return s.a.useEffect((()=>{let n=b.collection(e).orderBy("createdAt");if(t){if(!t.compareValue||!t.compareValue.length)return void o([]);n=n.where(t.fieldName,t.operator,t.compareValue)}return n.onSnapshot((e=>{const t=e.docs.map((e=>({...e.data(),id:e.id})));o(t)}))}),[e,t]),n};const S=s.a.createContext();function U(e){let{children:t}=e;const[n,o]=Object(a.useState)(!1),[c,i]=Object(a.useState)(!1),[r,l]=Object(a.useState)(""),{user:{uid:d}}=s.a.useContext(N),j=s.a.useMemo((()=>({fieldName:"members",operator:"array-contains",compareValue:d})),[d]),u=L("rooms",j),b=s.a.useMemo((()=>u.find((e=>e.id===r))||{}),[u,r]),m=s.a.useMemo((()=>({fieldName:"uid",operator:"in",compareValue:b.members})),[b.members]),h=L("users",m);return Object(x.jsx)(S.Provider,{value:{rooms:u,members:h,selectedRoom:b,isAddRoomVisible:n,setIsAddRoomVisible:o,selectedRoomId:r,setSelectedRoomId:l,isInviteMemberVisible:c,setIsInviteMemberVisible:i,clearState:()=>{l(""),o(!1),i(!1)}},children:t})}var V;const F=R.a.div(V||(V=Object(C.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n\n  .username {\n    color: white;\n    margin-left: 5px;\n  }\n"])));function k(){var e;const{user:{displayName:t,photoURL:n}}=s.a.useContext(N),{clearState:a}=s.a.useContext(S);return Object(x.jsxs)(F,{children:[Object(x.jsxs)("div",{children:[Object(x.jsx)(I.a,{src:n,children:n?"":null===t||void 0===t||null===(e=t.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(x.jsx)(i.a.Text,{className:"username",children:t})]}),Object(x.jsx)(d.a,{ghost:!0,onClick:()=>{a(),u.signOut()},children:"Log out"})]})}var M,T,E=n(259),_=n(264);const{Panel:z}=E.a,P=Object(R.a)(z)(M||(M=Object(C.a)(["\n  &&& {\n    .ant-collapse-header,\n    p {\n      color: white;\n    }\n\n    .ant-collapse-content-box {\n      padding: 0 40px;\n    }\n\n    .add-room {\n      color: white;\n      padding: 0;\n    }\n  }\n"]))),B=Object(R.a)(i.a.Link)(T||(T=Object(C.a)(["\n  display: block;\n  margin-bottom: 5px;\n  color: white;\n"])));function D(){const{rooms:e,setIsAddRoomVisible:t,setSelectedRoomId:n}=s.a.useContext(S);return Object(x.jsx)(E.a,{ghost:!0,defaultActiveKey:["1"],children:Object(x.jsxs)(P,{header:"List of rooms",children:[e.map((e=>Object(x.jsx)(B,{onClick:()=>n(e.id),children:e.name},e.id))),Object(x.jsx)(d.a,{type:"text",icon:Object(x.jsx)(_.a,{}),className:"add-room",onClick:()=>{t(!0)},children:"Add another room"})]},"1")})}var G;const K=R.a.div(G||(G=Object(C.a)(["\n  background: #3f0e40;\n  color: white;\n  height: 100vh;\n"])));function J(){return Object(x.jsx)(K,{children:Object(x.jsxs)(r.a,{children:[Object(x.jsx)(l.a,{span:24,children:Object(x.jsx)(k,{})}),Object(x.jsx)(l.a,{span:24,children:Object(x.jsx)(D,{})})]})})}var H,q=n(265),Q=n(256),W=n(65),X=n(260),Y=n(263),Z=n(255);const $=R.a.div(H||(H=Object(C.a)(["\n  margin-bottom: 10px;\n\n  .author {\n    margin-left: 5px;\n    font-weight: bold;\n  }\n\n  .date {\n    margin-left: 10px;\n    font-size: 11px;\n    color: #a7a7a7;\n  }\n\n  .content {\n    margin-left: 30px;\n  }\n"])));function ee(e){let t="";return e&&(t=Object(Z.a)(new Date(1e3*e),new Date),t=t.charAt(0).toUpperCase()+t.slice(1)),t}function te(e){var t;let{text:n,displayName:a,createdAt:s,photoURL:o}=e;return Object(x.jsxs)($,{children:[Object(x.jsxs)("div",{children:[Object(x.jsx)(I.a,{size:"small",src:o,children:o?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(x.jsx)(i.a.Text,{className:"author",children:a}),Object(x.jsx)(i.a.Text,{className:"date",children:ee(null===s||void 0===s?void 0:s.seconds)})]}),Object(x.jsx)("div",{children:Object(x.jsx)(i.a.Text,{className:"content",children:n})})]})}var ne,ae,se,oe,ce,ie;const re=R.a.div(ne||(ne=Object(C.a)(["\n  display: flex;\n  justify-content: space-between;\n  height: 56px;\n  padding: 0 16px;\n  align-items: center;\n  border-bottom: 1px solid rgb(230, 230, 230);\n\n  .header {\n    &__info {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n\n    &__title {\n      margin: 0;\n      font-weight: bold;\n    }\n\n    &__description {\n      font-size: 12px;\n    }\n  }\n"]))),le=R.a.div(ae||(ae=Object(C.a)(["\n  display: flex;\n  align-items: center;\n"]))),de=R.a.div(se||(se=Object(C.a)(["\n  height: 100vh;\n"]))),je=R.a.div(oe||(oe=Object(C.a)(["\n  height: calc(100% - 56px);\n  display: flex;\n  flex-direction: column;\n  padding: 11px;\n  justify-content: flex-end;\n"]))),ue=Object(R.a)(Q.a)(ce||(ce=Object(C.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2px 2px 2px 0;\n  border: 1px solid rgb(230, 230, 230);\n  border-radius: 2px;\n\n  .ant-form-item {\n    flex: 1;\n    margin-bottom: 0;\n  }\n"]))),be=R.a.div(ie||(ie=Object(C.a)(["\n  max-height: 100%;\n  overflow-y: auto;\n"])));function me(){const{selectedRoom:e,members:t,setIsInviteMemberVisible:n}=Object(a.useContext)(S),{user:{uid:o,photoURL:c,displayName:i}}=Object(a.useContext)(N),[r,l]=Object(a.useState)(""),[j]=Q.a.useForm(),u=Object(a.useRef)(null),b=Object(a.useRef)(null),m=()=>{h("messages",{text:r,uid:o,photoURL:c,roomId:e.id,displayName:i}),j.resetFields(["message"]),(null===u||void 0===u?void 0:u.current)&&setTimeout((()=>{u.current.focus()}))},p=s.a.useMemo((()=>({fieldName:"roomId",operator:"==",compareValue:e.id})),[e.id]),O=L("messages",p);return Object(a.useEffect)((()=>{(null===b||void 0===b?void 0:b.current)&&(b.current.scrollTop=b.current.scrollHeight+50)}),[O]),Object(x.jsx)(de,{children:e.id?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(re,{children:[Object(x.jsxs)("div",{className:"header__info",children:[Object(x.jsx)("p",{className:"header__title",children:e.name}),Object(x.jsx)("span",{className:"header__description",children:e.description})]}),Object(x.jsxs)(le,{children:[Object(x.jsx)(d.a,{icon:Object(x.jsx)(q.a,{}),type:"text",onClick:()=>n(!0),children:"Invite"}),Object(x.jsx)(I.a.Group,{size:"small",maxCount:2,children:t.map((e=>{var t,n;return Object(x.jsx)(W.a,{title:e.displayName,children:Object(x.jsx)(I.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(x.jsxs)(je,{children:[Object(x.jsx)(be,{ref:b,children:O.map((e=>Object(x.jsx)(te,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt},e.id)))}),Object(x.jsxs)(ue,{form:j,children:[Object(x.jsx)(Q.a.Item,{name:"message",children:Object(x.jsx)(X.a,{ref:u,onChange:e=>{l(e.target.value)},onPressEnter:m,placeholder:"Enter message...",bordered:!1,autoComplete:"off"})}),Object(x.jsx)(d.a,{type:"primary",onClick:m,children:"Send"})]})]})]}):Object(x.jsx)(Y.a,{message:"Please select a room",type:"info",showIcon:!0,style:{margin:5},closable:!0})})}function he(){return Object(x.jsx)("div",{children:Object(x.jsxs)(r.a,{children:[Object(x.jsx)(l.a,{span:6,children:Object(x.jsx)(J,{})}),Object(x.jsx)(l.a,{span:18,children:Object(x.jsx)(me,{})})]})})}var pe=n(261);function xe(){const{isAddRoomVisible:e,setIsAddRoomVisible:t}=Object(a.useContext)(S),{user:{uid:n}}=Object(a.useContext)(N),[s]=Q.a.useForm();return Object(x.jsx)("div",{children:Object(x.jsx)(pe.a,{title:"Create room",visible:e,onOk:()=>{console.log({FormData:s.getFieldValue()}),h("rooms",{...s.getFieldsValue(),members:[n]}),s.resetFields(),t(!1)},onCancel:()=>{s.resetFields(),t(!1)},children:Object(x.jsxs)(Q.a,{form:s,layout:"vertical",children:[Object(x.jsx)(Q.a.Item,{label:"Room name",name:"name",children:Object(x.jsx)(X.a,{placeholder:"Enter the room name"})}),Object(x.jsx)(Q.a.Item,{label:"Description",name:"description",children:Object(x.jsx)(X.a.TextArea,{placeholder:"Enter a description"})})]})})})}var Oe=n(258),fe=n(149);function ve(e){let{fetchOptions:t,debounceTimeout:n=300,curMembers:o,...c}=e;const[i,r]=Object(a.useState)(!1),[l,d]=Object(a.useState)([]),j=s.a.useMemo((()=>Object(fe.debounce)((e=>{d([]),r(!0),t(e,o).then((e=>{d(e),r(!1)}))}),n)),[n,t,o]);return s.a.useEffect((()=>()=>{d([])}),[]),Object(x.jsx)(Oe.a,{labelInValue:!0,filterOption:!1,onSearch:j,notFoundContent:i?Object(x.jsx)(w.a,{size:"small"}):null,...c,children:l.map((e=>{var t,n;return Object(x.jsxs)(Oe.a.Option,{value:e.value,title:e.label,children:[Object(x.jsx)(I.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))})}async function ge(e,t){return b.collection("users").where("keywords","array-contains",null===e||void 0===e?void 0:e.toLowerCase()).orderBy("displayName").limit(20).get().then((e=>e.docs.map((e=>({label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}))).filter((e=>!t.includes(e.value)))))}function ye(){const{isInviteMemberVisible:e,setIsInviteMemberVisible:t,selectedRoomId:n,selectedRoom:s}=Object(a.useContext)(S),[o,c]=Object(a.useState)([]),[i]=Q.a.useForm();return Object(x.jsx)("div",{children:Object(x.jsx)(pe.a,{title:"Invite more members",visible:e,onOk:()=>{i.resetFields(),c([]);b.collection("rooms").doc(n).update({members:[...s.members,...o.map((e=>e.value))]}),t(!1)},onCancel:()=>{i.resetFields(),c([]),t(!1)},destroyOnClose:!0,children:Object(x.jsx)(Q.a,{form:i,layout:"vertical",children:Object(x.jsx)(ve,{mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:o,placeholder:"Enter member name",fetchOptions:ge,onChange:e=>c(e),style:{width:"100%"},curMembers:s.members})})})})}var Ce=function(){return Object(x.jsx)(g.a,{children:Object(x.jsx)(A,{children:Object(x.jsxs)(U,{children:[Object(x.jsxs)(y.c,{children:[Object(x.jsx)(y.a,{component:v,path:"/login"}),Object(x.jsx)(y.a,{component:he,path:"/"})]}),Object(x.jsx)(xe,{}),Object(x.jsx)(ye,{})]})})})};var Ie=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,266)).then((t=>{let{getCLS:n,getFID:a,getFCP:s,getLCP:o,getTTFB:c}=t;n(e),a(e),s(e),o(e),c(e)}))};c.a.render(Object(x.jsx)(Ce,{}),document.getElementById("root")),Ie()}},[[247,1,2]]]);
//# sourceMappingURL=main.19c4c4c0.chunk.js.map